C251 COMPILER V5.60.0,  Timer_Isr                                                          10/11/25  23:53:06  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE Timer_Isr
OBJECT MODULE PLACED IN .\Objects\Timer_Isr.obj
COMPILER INVOKED BY: C:\Keil_v5\C251\BIN\C251.EXE Sources\isr\Timer_Isr.c XSMALL INTR2 BROWSE INCDIR(.\Sources\inc) DEBU
                    -G PRINT(.\Listings\Timer_Isr.lst) TABS(2) OBJECT(.\Objects\Timer_Isr.obj) 

stmt  level    source

    1          /*---------------------------------------------------------------------*/
    2          /* --- Web: www.STCAI.com ---------------------------------------------*/
    3          /*---------------------------------------------------------------------*/
    4          
    5          #include "config.h"
    6          #include "Task.h"
    7          
    8          //========================================================================
    9          //                            全局时间戳（1ms时基）
   10          //========================================================================
   11          // 注意：在app_intKey.c中声明为extern，这里只递增
   12          // 如果ENABLE_INT_KEY=0，这个变量不会被使用
   13          #if ENABLE_INT_KEY
   14          extern volatile u32 system_tick_ms;
   15          #endif
   16          
   17          //========================================================================
   18          // 函数: Timer0_ISR_Handler
   19          // 描述: Timer0中断函数.
   20          // 参数: none.
   21          // 返回: none.
   22          // 版本: V1.0, 2020-09-23
   23          // 优化: V1.1, 2025-10-21 - 添加中断嵌套保护
   24          //========================================================================
   25          void Timer0_ISR_Handler (void) interrupt TMR0_VECTOR    //进中断时已经清除标志
   26          {
   27   1          //========================================================================
   28   1          // 优化2：禁止中断嵌套（保证ISR执行时间可控）
   29   1          // 执行时间：~25μs @ 48MHz（或 ~50μs @ 24MHz）
   30   1          // 期间其他中断会被延迟，但硬件外设（I2C/SPI/ADC/PWM）仍正常工作
   31   1          //========================================================================
   32   1          EA = 0;  // 禁止全局中断，防止中断嵌套
   33   1          
   34   1          //========================================================================
   35   1          // 全局1ms时基递增（用于状态机延时和按键事件时间戳）
   36   1          // 开销：<0.5μs，CPU占用增加<0.5%
   37   1          //========================================================================
   38   1      #if ENABLE_INT_KEY
   39   1          system_tick_ms++;  // 全局毫秒计数器递增
   40   1      #endif
   41   1          
   42   1          Task_Marks_Handler_Callback();  //任务标记回调函数
   43   1          
   44   1          EA = 1;  // 恢复全局中断
   45   1          //========================================================================
   46   1      }
   47          
   48          //========================================================================
   49          // 函数: Timer1_ISR_Handler
   50          // 描述: Timer1中断函数.
   51          // 参数: none.
   52          // 返回: none.
   53          // 版本: V1.0, 2020-09-23
   54          //========================================================================
   55          void Timer1_ISR_Handler (void) interrupt TMR1_VECTOR    //进中断时已经清除标志
   56          {
   57   1        // TODO: 在此处添加用户代码
   58   1        P66 = ~P66;
C251 COMPILER V5.60.0,  Timer_Isr                                                          10/11/25  23:53:06  PAGE 2   

   59   1      }
   60          
   61          //========================================================================
   62          // 函数: Timer2_ISR_Handler
   63          // 描述: Timer2中断函数.
   64          // 参数: none.
   65          // 返回: none.
   66          // 版本: V1.0, 2020-09-23
   67          //========================================================================
   68          void Timer2_ISR_Handler (void) interrupt TMR2_VECTOR    //进中断时已经清除标志
   69          {
   70   1        // TODO: 在此处添加用户代码
   71   1        P65 = ~P65;
   72   1      }
   73          
   74          //========================================================================
   75          // 函数: Timer3_ISR_Handler
   76          // 描述: Timer3中断函数.
   77          // 参数: none.
   78          // 返回: none.
   79          // 版本: V1.0, 2020-09-23
   80          //========================================================================
   81          void Timer3_ISR_Handler (void) interrupt TMR3_VECTOR    //进中断时已经清除标志
   82          {
   83   1        // TODO: 在此处添加用户代码
   84   1        P64 = ~P64;
   85   1      }
   86          
   87          //========================================================================
   88          // 函数: Timer4_ISR_Handler
   89          // 描述: Timer4中断函数.
   90          // 参数: none.
   91          // 返回: none.
   92          // 版本: V1.0, 2020-09-23
   93          //========================================================================
   94          void Timer4_ISR_Handler (void) interrupt TMR4_VECTOR    //进中断时已经清除标志
   95          {
   96   1        // TODO: 在此处添加用户代码
   97   1        P63 = ~P63;
   98   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       105     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =    ------     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
